(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{309:function(a,s,n){"use strict";n.r(s);var e=n(0),t=Object(e.a)({},(function(){var a=this,s=a.$createElement,n=a._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("h1",{attrs:{id:"docker常用容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker常用容器","aria-hidden":"true"}},[a._v("#")]),a._v(" Docker常用容器")]),a._v(" "),n("h2",{attrs:{id:"nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx","aria-hidden":"true"}},[a._v("#")]),a._v(" nginx")]),a._v(" "),n("h3",{attrs:{id:"创建目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建目录","aria-hidden":"true"}},[a._v("#")]),a._v(" 创建目录")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("mkdir -p /data/nginx/{config,logs,data}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("h3",{attrs:{id:"配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置文件","aria-hidden":"true"}},[a._v("#")]),a._v(" 配置文件")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("user  nginx;\nworker_processes  1;\n\nevents {\n    worker_connections  1024;\n}\n\nhttp {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    sendfile        on;\n    keepalive_timeout  65;\n\n    server{\n      listen  80;\n\n      # ip:port 或 域名\n      server_name 0.0.0.0:80;\n\n      # 比如，公众号要求 txt文件安全认证\n      location ~* .(txt)$ {\n        root /var/opt/nginx/txt/;\n      }\n\n      # 不缓存页面\n      location /hello-world {\n          alias /var/opt/nginx/hello-world/;\n          add_header Last-Modified $date_gmt;\n          expires -1s;\n          index index.html index.htm;\n          try_files $uri $uri/ /hello-world/index.html;\n      }\n\n      # 跨域请求\n      location /static {\n        add_header Access-Control-Allow-Origin *;\n        add_header Access-Control-Allow-Credentials 'true';\n        add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';\n        add_header Access-Control-Allow-Headers 'DNT,web-token,app-token,Authorization,Accept,Origin,Keep-Alive,User-Agent,X-Mx-ReqToken,X-Data-Type,X-Auth-Token,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';\n        add_header Access-Control-Expose-Headers 'Content-Length,Content-Range';\n        if ($request_method = 'OPTIONS') {\n          add_header 'Access-Control-Max-Age' 1728000;\n          add_header 'Content-Type' 'text/plain; charset=utf-8';\n          add_header 'Content-Length' 0;\n          return 204;\n        }\n        root /var/opt/nginx/;\n      }\n\n      # / 放到最后\n      location / {\n        root /var/opt/nginx;\n        index index.html index.htm;\n        try_files $uri $uri/ /index.html;\n      }\n    }\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br"),n("span",{staticClass:"line-number"},[a._v("17")]),n("br"),n("span",{staticClass:"line-number"},[a._v("18")]),n("br"),n("span",{staticClass:"line-number"},[a._v("19")]),n("br"),n("span",{staticClass:"line-number"},[a._v("20")]),n("br"),n("span",{staticClass:"line-number"},[a._v("21")]),n("br"),n("span",{staticClass:"line-number"},[a._v("22")]),n("br"),n("span",{staticClass:"line-number"},[a._v("23")]),n("br"),n("span",{staticClass:"line-number"},[a._v("24")]),n("br"),n("span",{staticClass:"line-number"},[a._v("25")]),n("br"),n("span",{staticClass:"line-number"},[a._v("26")]),n("br"),n("span",{staticClass:"line-number"},[a._v("27")]),n("br"),n("span",{staticClass:"line-number"},[a._v("28")]),n("br"),n("span",{staticClass:"line-number"},[a._v("29")]),n("br"),n("span",{staticClass:"line-number"},[a._v("30")]),n("br"),n("span",{staticClass:"line-number"},[a._v("31")]),n("br"),n("span",{staticClass:"line-number"},[a._v("32")]),n("br"),n("span",{staticClass:"line-number"},[a._v("33")]),n("br"),n("span",{staticClass:"line-number"},[a._v("34")]),n("br"),n("span",{staticClass:"line-number"},[a._v("35")]),n("br"),n("span",{staticClass:"line-number"},[a._v("36")]),n("br"),n("span",{staticClass:"line-number"},[a._v("37")]),n("br"),n("span",{staticClass:"line-number"},[a._v("38")]),n("br"),n("span",{staticClass:"line-number"},[a._v("39")]),n("br"),n("span",{staticClass:"line-number"},[a._v("40")]),n("br"),n("span",{staticClass:"line-number"},[a._v("41")]),n("br"),n("span",{staticClass:"line-number"},[a._v("42")]),n("br"),n("span",{staticClass:"line-number"},[a._v("43")]),n("br"),n("span",{staticClass:"line-number"},[a._v("44")]),n("br"),n("span",{staticClass:"line-number"},[a._v("45")]),n("br"),n("span",{staticClass:"line-number"},[a._v("46")]),n("br"),n("span",{staticClass:"line-number"},[a._v("47")]),n("br"),n("span",{staticClass:"line-number"},[a._v("48")]),n("br"),n("span",{staticClass:"line-number"},[a._v("49")]),n("br"),n("span",{staticClass:"line-number"},[a._v("50")]),n("br"),n("span",{staticClass:"line-number"},[a._v("51")]),n("br"),n("span",{staticClass:"line-number"},[a._v("52")]),n("br"),n("span",{staticClass:"line-number"},[a._v("53")]),n("br"),n("span",{staticClass:"line-number"},[a._v("54")]),n("br"),n("span",{staticClass:"line-number"},[a._v("55")]),n("br"),n("span",{staticClass:"line-number"},[a._v("56")]),n("br"),n("span",{staticClass:"line-number"},[a._v("57")]),n("br"),n("span",{staticClass:"line-number"},[a._v("58")]),n("br")])]),n("h3",{attrs:{id:"data目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#data目录","aria-hidden":"true"}},[a._v("#")]),a._v(" data目录")]),a._v(" "),n("p",[a._v("/data/nginx/data/{index.html,mobile,hello-world}")]),a._v(" "),n("h3",{attrs:{id:"前端打包方式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前端打包方式","aria-hidden":"true"}},[a._v("#")]),a._v(" 前端打包方式")]),a._v(" "),n("ul",[n("li",[n("strong",[a._v("mobile")]),a._v(" 项目使用相对路径"),n("br"),a._v("\npublicPath: './' （或 publicPath: ''）"),n("br")]),a._v(" "),n("li",[n("strong",[a._v("推荐")]),a._v(" "),n("strong",[a._v("hello-world")]),a._v(" 项目使用绝对路径"),n("br"),a._v("\npublicPath: '/hello-world'"),n("br"),a._v(" "),n("strong",[a._v("推荐该方式")]),a._v("，相比于"),n("code",[a._v("1")]),a._v("，可以更好地配置请求路径，如public文件夹下的文件等。")])]),a._v(" "),n("h3",{attrs:{id:"docker-启动命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker-启动命令","aria-hidden":"true"}},[a._v("#")]),a._v(" docker 启动命令")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("docker run --restart=always \\\n  -d --name nginx \\\n  -p 80:80 \\\n  -v /Users/jasvtfvan/Documents/data/nginx/config/nginx.conf:/etc/nginx/nginx.conf:ro \\\n  -v /Users/jasvtfvan/Documents/data/nginx/logs:/var/log/nginx \\\n  -v /Users/jasvtfvan/Documents/data/nginx/data:/var/opt/nginx \\\n  nginx:1.14.2\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br")])]),n("h3",{attrs:{id:"访问地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#访问地址","aria-hidden":"true"}},[a._v("#")]),a._v(" 访问地址")]),a._v(" "),n("blockquote",[n("p",[a._v("访问地址需要使用ip")])]),a._v(" "),n("ol",[n("li",[a._v("http://192.168.3.2 => nginx首页")]),a._v(" "),n("li",[a._v("http://192.168.3.2/mobile => mobile项目")]),a._v(" "),n("li",[a._v("http://1926.168.3.2/hello-world => hello-world项目")])]),a._v(" "),n("hr"),a._v(" "),n("h2",{attrs:{id:"gitlab"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#gitlab","aria-hidden":"true"}},[a._v("#")]),a._v(" gitlab")]),a._v(" "),n("h3",{attrs:{id:"创建目录-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建目录-2","aria-hidden":"true"}},[a._v("#")]),a._v(" 创建目录")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("mkdir -p /data/gitlabzh/{config,logs,data}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("p",[a._v("gitlab(8080 used by docker, cannot use 8080):")]),a._v(" "),n("h3",{attrs:{id:"拉取镜像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#拉取镜像","aria-hidden":"true"}},[a._v("#")]),a._v(" 拉取镜像")]),a._v(" "),n("p",[n("em",[n("strong",[a._v("运行时发现本地没有镜像，自动拉取官网镜像")])])]),a._v(" "),n("ul",[n("li",[a._v("官网英文镜像\ndocker pull gitlab/gitlab-ce:latest")]),a._v(" "),n("li",[a._v("社区中文镜像\ndocker pull beginor/gitlab-ce:11.3.0-ce.0")])]),a._v(" "),n("h3",{attrs:{id:"初始化gitlab容器-chinese"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化gitlab容器-chinese","aria-hidden":"true"}},[a._v("#")]),a._v(" 初始化gitlab容器 (chinese):")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("sudo docker run --restart=always \\\n  --detach \\\n  --publish 443:443 \\\n  --publish 222:22 \\\n  --publish 8090:80 \\\n  --name gitlabzh \\\n  --restart always \\\n  --volume /data/gitlabzh/config:/etc/gitlabzh \\\n  --volume /data/gitlabzh/logs:/var/log/gitlabzh \\\n  --volume /data/gitlabzh/data:/var/opt/gitlabzh \\\n  beginor/gitlab-ce:11.3.0-ce.0\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br")])]),n("h3",{attrs:{id:"初始化gitlab容器-english"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化gitlab容器-english","aria-hidden":"true"}},[a._v("#")]),a._v(" 初始化gitlab容器 (english):")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("sudo docker run --restart=always \\\n  --detach \\\n  --publish 8443:443 \\\n  --publish 8222:22 \\\n  --publish 8089:80 \\\n  --name gitlab \\\n  --restart always \\\n  -v /data/gitlab/config:/etc/gitlab \\\n  --volume /data/gitlab/logs:/var/log/gitlab \\\n  --volume /data/gitlab/data:/var/opt/gitlab \\\n  gitlab/gitlab-ce:latest\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br")])]),n("h3",{attrs:{id:"首次加载"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#首次加载","aria-hidden":"true"}},[a._v("#")]),a._v(" 首次加载")]),a._v(" "),n("p",[a._v("首次加载需要等待初始化，因此首次开启gitlab页面很慢，请耐心等待")]),a._v(" "),n("hr"),a._v(" "),n("h2",{attrs:{id:"redis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#redis","aria-hidden":"true"}},[a._v("#")]),a._v(" redis")]),a._v(" "),n("h3",{attrs:{id:"创建目录-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建目录-3","aria-hidden":"true"}},[a._v("#")]),a._v(" 创建目录")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("mkdir -p /data/redis/{conf,data}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("h3",{attrs:{id:"redis配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#redis配置文件","aria-hidden":"true"}},[a._v("#")]),a._v(" redis配置文件")]),a._v(" "),n("p",[a._v("默认情况不需要，如果需要编辑配置文件")]),a._v(" "),n("h3",{attrs:{id:"初始化redis容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化redis容器","aria-hidden":"true"}},[a._v("#")]),a._v(" 初始化redis容器")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("sudo docker run --restart=always \\\n  -d --name redis \\\n  -p 6379:6379 \\\n  -v /data/redis/data:/var/opt/redis \\\n -v /data/redis/config/redis.conf:/etc/redis/redis.conf:ro \\\n  redis redis-server --appendonly yes\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br")])]),n("h3",{attrs:{id:"测试redis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试redis","aria-hidden":"true"}},[a._v("#")]),a._v(" 测试redis")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("docker exec -it redis redis-cli -h localhost -p 6379\n\nselect 1\n\nkeys *\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br")])]),n("hr"),a._v(" "),n("h2",{attrs:{id:"mongo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mongo","aria-hidden":"true"}},[a._v("#")]),a._v(" mongo")]),a._v(" "),n("h3",{attrs:{id:"创建目录-4"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建目录-4","aria-hidden":"true"}},[a._v("#")]),a._v(" 创建目录")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("mkdir -p /data/mongo/data\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("h3",{attrs:{id:"初始化运行容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化运行容器","aria-hidden":"true"}},[a._v("#")]),a._v(" 初始化运行容器")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("sudo docker run --restart=always \\\n  -d --name mongo \\\n  -p 27017:27017 \\\n  -v /data/mongo/data:/var/opt/mongo \\\n  mongo\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br")])]),n("h3",{attrs:{id:"测试mongo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试mongo","aria-hidden":"true"}},[a._v("#")]),a._v(" 测试mongo")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("docker exec -it mongo mongo admin\nshow dbs\nuse local\nshow collections\ndb.startup_log.find()\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br")])]),n("hr")])}),[],!1,null,null,null);s.default=t.exports}}]);