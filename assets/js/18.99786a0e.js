(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{243:function(s,a,t){s.exports=t.p+"assets/img/docker-arch.c4971390.jpg"},311:function(s,a,t){"use strict";t.r(a);var e=t(0),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"常规部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常规部署","aria-hidden":"true"}},[s._v("#")]),s._v(" 常规部署")]),s._v(" "),e("ol",[e("li",[s._v("购买自己的域名")]),s._v(" "),e("li",[s._v("域名备案")]),s._v(" "),e("li",[s._v("购买服务器")]),s._v(" "),e("li",[s._v("配置服务器应用环境")]),s._v(" "),e("li",[s._v("安装配置服务器")]),s._v(" "),e("li",[s._v("项目远程部署和发布与更新")])]),s._v(" "),e("h2",{attrs:{id:"_1-服务器购买与备案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-服务器购买与备案","aria-hidden":"true"}},[s._v("#")]),s._v(" 1. 服务器购买与备案")]),s._v(" "),e("h3",{attrs:{id:"_1-1-购买域名"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-购买域名","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.1 购买域名")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://wanwang.aliyun.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("阿里云"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://dnspod.cloud.tencent.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("腾讯云"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://cloud.baidu.com/product/bcd.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("百度云"),e("OutboundLink")],1)])]),s._v(" "),e("h3",{attrs:{id:"_1-2-云主机"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-云主机","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.2 云主机")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.aliyun.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("阿里云 ECS"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://aws.amazon.com/cn",target:"_blank",rel:"noopener noreferrer"}},[s._v("亚马逊 AWS"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://cloud.tencent.com/product/cvm",target:"_blank",rel:"noopener noreferrer"}},[s._v("腾讯云"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://cloud.baidu.com/product/bcc.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("百度云"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("华为云(面向企业)")]),s._v(" "),e("li",[s._v("google云(集成google的AI服务，尚未进入中国市场)")])]),s._v(" "),e("h3",{attrs:{id:"_1-3-购买服务器（阿里云）"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-购买服务器（阿里云）","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.3 购买服务器（阿里云）")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://ecs-buy.aliyun.com/wizard/#/postpay/cn-beijing",target:"_blank",rel:"noopener noreferrer"}},[s._v("选择配置"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("镜像 CentOS 7.6 64位")])]),s._v(" "),e("h3",{attrs:{id:"_1-4-备案（阿里云）"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-备案（阿里云）","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.4 备案（阿里云）")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://beian.aliyun.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("阿里云备案"),e("OutboundLink")],1)]),s._v(" "),e("li",[e("a",{attrs:{href:"https://bsn.console.aliyun.com/#/bsnManagement",target:"_blank",rel:"noopener noreferrer"}},[s._v("备案管理"),e("OutboundLink")],1)])]),s._v(" "),e("h2",{attrs:{id:"_2-服务器部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-服务器部署","aria-hidden":"true"}},[s._v("#")]),s._v(" 2. 服务器部署")]),s._v(" "),e("h3",{attrs:{id:"_2-1-客户端工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-客户端工具","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.1 客户端工具")]),s._v(" "),e("ul",[e("li",[s._v("工具下载 "),e("a",{attrs:{href:"https://git-scm.com/downloads",target:"_blank",rel:"noopener noreferrer"}},[s._v("git bash"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("推荐教程 "),e("a",{attrs:{href:"https://www.liaoxuefeng.com/wiki/896043488029600",target:"_blank",rel:"noopener noreferrer"}},[s._v("Git教程-廖雪峰的官方网站"),e("OutboundLink")],1)])]),s._v(" "),e("h3",{attrs:{id:"_2-2-连接服务器-心跳"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-连接服务器-心跳","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2 连接服务器(心跳)")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@服务器ip\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("查看系统版本")])]),s._v(" "),e("blockquote",[e("p",[e("code",[s._v("lsb_release -a")])])]),s._v(" "),e("h4",{attrs:{id:"_2-2-1-查看客户端ssh配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-查看客户端ssh配置","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2.1 查看客户端ssh配置")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/ssh\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ssh_config "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v ^"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# | grep -v ^$")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -l\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("blockquote",[e("p",[e("code",[s._v("cat ssh_config | grep -v ^# | grep -v ^$")]),s._v(": 查看配置信息"),e("br"),s._v(" "),e("code",[s._v("ls -l")]),s._v(": 查看文件权限"),e("br"),s._v(" "),e("code",[s._v("-rwxr--r--")]),s._v(": 所有者可读可写可执行，用户所在组只读，其他人只读"),e("br")])]),s._v(" "),e("h4",{attrs:{id:"_2-2-2-修改文件读写权限"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-修改文件读写权限","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2.2 修改文件读写权限")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v(" ssh_config\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_2-2-3-配置客户端连接检测参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-配置客户端连接检测参数","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2.3 配置客户端连接检测参数")]),s._v(" "),e("p",[s._v("如果没有下边的参数，添加到配置文件末尾")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/ssh/ssh_config\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("ServerAliveInterval "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\nServerAliveCountMax "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("blockquote",[e("p",[e("code",[s._v("ServerAliveInterval 60")]),s._v(": client每隔60秒发送一次请求给server，然后server响应，从而保持连接"),e("br"),s._v(" "),e("code",[s._v("ServerAliveCountMax 3")]),s._v(": client发出请求后，服务器端没有响应得次数达到3，就自动断开连接，正常情况下，server不会不响应")])]),s._v(" "),e("h3",{attrs:{id:"_2-3-创建非root用户"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-创建非root用户","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.3 创建非root用户")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("adduser zhangsan\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_2-4-授予权限"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-授予权限","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.4 授予权限")]),s._v(" "),e("p",[e("code",[s._v("gpasswd")]),s._v("命令是Linux下工作组文件"),e("code",[s._v("/etc/group")]),s._v("和"),e("code",[s._v("/etc/gshadow")]),s._v("管理工具。")]),s._v(" "),e("blockquote",[e("p",[e("code",[s._v("-a")]),s._v(": 添加用户到组"),e("br"),s._v(" "),e("code",[s._v("-d")]),s._v(": 从组删除用户")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" gpasswd -a zhangsan\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_2-5-添加sudo权限"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-添加sudo权限","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.5 添加sudo权限")]),s._v(" "),e("ul",[e("li",[s._v("Linux用户配置sudo权限"),e("code",[s._v("visudo")]),s._v(",如果你用"),e("code",[s._v("visudo")]),s._v("来编辑这个文件，那么它会帮你自动做很多事情，比如说语法检查，加锁防止别人同时修改这个文件等等")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" visudo\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("或者")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/sudoers\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("visudo 等价于 /etc/sudoers")])]),s._v(" "),e("p",[s._v("增加以下内容")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# User privilege specification")]),s._v("\nzhangsan "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL:ALL"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ALL\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v('1 "From ALL hosts", zhangsan 从任何机器登录，都可以应用接下来的规则')]),s._v(" "),e("li",[s._v('2 "Run As ALL User", zhangsan"可以以任何用户的身份运行一些命令')]),s._v(" "),e("li",[s._v('3 "Run As All Groups", zhangsan"可以以任何用户组的身份运行一些命令')]),s._v(" "),e("li",[s._v("4 前面的规定适用于任何命令")])]),s._v(" "),e("blockquote",[e("p",[e("code",[s._v("zhangsan")]),s._v("这个用户可以从任何机器登录，以任何用户和用户组的身份运行任何命令。 保存并退出")])]),s._v(" "),e("h3",{attrs:{id:"_2-6-修改非root用户密码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-修改非root用户密码","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.6 修改非root用户密码")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" zhangsan\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_2-7-ssh无密码登录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-ssh无密码登录","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.7 SSH无密码登录")]),s._v(" "),e("p",[s._v("ssh 公钥认证是ssh认证的方式之一。通过公钥认证可实现ssh免密码登陆，git的ssh方式也是通过公钥进行认证的。")]),s._v(" "),e("h4",{attrs:{id:"_2-7-1-本地生成公钥和私钥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-1-本地生成公钥和私钥","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.7.1 本地生成公钥和私钥")]),s._v(" "),e("ul",[e("li",[s._v("查看本地公钥私钥，如果存在不再生成")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -al ~/.ssh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("生成公钥和私钥")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("ssh-keygen --help\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/.ssh\nssh-keygen -t rsa -b "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("blockquote",[e("p",[s._v("-t 指定加密方式"),e("br"),s._v("\n-b 字节数")])]),s._v(" "),e("h4",{attrs:{id:"_2-7-2-开启ssh代理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-2-开启ssh代理","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.7.2 开启ssh代理")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("eval")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("ssh-agent -s"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v("\nssh-add ~/.ssh/id_rsa\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("blockquote",[e("p",[s._v("加速秘钥验证过程")])]),s._v(" "),e("h4",{attrs:{id:"_2-7-3-服务器生成公钥和私钥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-3-服务器生成公钥和私钥","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.7.3 服务器生成公钥和私钥")]),s._v(" "),e("ul",[e("li",[s._v("1 查看公钥私钥是否存在，参考本地操作")]),s._v(" "),e("li",[s._v("2 生成公钥和私钥，并开启ssh代理")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("ssh-keygen -t rsa -b "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("eval")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("ssh-agent -s"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v("\nssh-add ~/.ssh/id_rsa\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_2-7-4-把本地的公钥上传到服务器授权文件中"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-4-把本地的公钥上传到服务器授权文件中","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.7.4 把本地的公钥上传到服务器授权文件中")]),s._v(" "),e("ul",[e("li",[s._v("1 本地查看公钥，复制"),e("code",[s._v("公钥")])])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ~/.ssh/id_rsa.pub\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("2 上传到服务器授权文件，粘贴"),e("code",[s._v("公钥")]),s._v("到"),e("code",[s._v("authorized_keys")])])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" ~/.ssh/authorized_keys\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v(" ~/.ssh/authorized_keys\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" sshd restart\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("blockquote",[e("p",[s._v("可读 可写 可执行"),e("br"),s._v("\n    1        1        1        (二进制)"),e("br"),s._v("\n2^2 * 1 + 2^1 * 1 + 2^0 * 0 = 6  所有者权限"),e("br"),s._v("\n2^2 * 0 + 2^1 * 0 + 2^0 * 0 = 0  所属组权限"),e("br"),s._v("\n2^2 * 0 + 2^1 * 0 + 2^0 * 0 = 0  其他人权限"),e("br"),s._v("\nchmod 600 >> 所有者可读可写，所属组和其他人没有任何权限")])]),s._v(" "),e("h4",{attrs:{id:"_2-7-5-重新登录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-5-重新登录","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.7.5 重新登录")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@服务器ip\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("blockquote",[e("p",[s._v("不再需要输入密码")])]),s._v(" "),e("h3",{attrs:{id:"_2-8-新服务器参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-新服务器参考","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.8 "),e("code",[s._v("新服务器")]),s._v("参考")]),s._v(" "),e("h4",{attrs:{id:"_2-8-1-阿里云新服务器密码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-1-阿里云新服务器密码","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.8.1 阿里云新服务器密码")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("密码: 实例密码 和 远程连接密码")]),e("br"),s._v("\n实例密码，用于客户端连接，即本地pc的ssh命令连接工具"),e("br"),s._v("\n远程连接密码(6位)，是阿里云开启web连接页面的密码")]),s._v(" "),e("li",[e("strong",[s._v("重置密码，是否需要重启?")]),e("br"),s._v("\n实例密码，需要重启实例"),e("br"),s._v("\n远程连接密码(6位)，不需要重启实例")]),s._v(" "),e("li",[s._v("登录连接")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@服务器ip\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("输入"),e("code",[s._v("实例密码")])])]),s._v(" "),e("h4",{attrs:{id:"_2-8-2-查看-ssh-known-hosts"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-2-查看-ssh-known-hosts","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.8.2 查看~/.ssh/known_hosts")]),s._v(" "),e("p",[s._v("记录已经通过连接的"),e("code",[s._v("服务器+公钥")]),s._v("信息")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" ~/.ssh/known_hosts\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("当第一次没有登录成功，不知道"),e("code",[s._v("公钥")]),s._v("是否被记录，可通过这个命令查看"),e("br"),s._v("\n使用"),e("code",[s._v("vim ~/.ssh/known_hosts")]),s._v("删除被错误记录的"),e("code",[s._v("公钥")]),e("br")])]),s._v(" "),e("h4",{attrs:{id:"_2-8-3-其他登录方案-不推荐"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-3-其他登录方案-不推荐","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.8.3 其他登录方案(不推荐)")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -o "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("StrictHostKeyChecking")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("no root@服务器ip\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("StrictHostKeyChecking公钥检查参数，不检查，不使用"),e("code",[s._v("公钥")]),s._v("连接"),e("br"),s._v("\n会被记录到 known_hosts")])]),s._v(" "),e("h3",{attrs:{id:"_2-9-安装软件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-9-安装软件","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.9 安装软件")]),s._v(" "),e("h4",{attrs:{id:"_2-8-1-更新系统"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-1-更新系统","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.8.1 更新系统")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("yum -y update   "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 升级所有包同时也升级软件和系统内核")]),s._v("\nyum -y upgrade  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只升级所有包，不升级软件和系统内核")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("blockquote",[e("p",[s._v("-y 代表所有提示 "),e("code",[s._v("yes or no ?")]),s._v(" 选择默认 yes")])]),s._v(" "),e("h4",{attrs:{id:"_2-8-2-查看依赖软件是否安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-2-查看依赖软件是否安装","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.8.2 查看依赖软件是否安装")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" --version\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" --version\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" --version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_2-8-3-安装软件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-3-安装软件","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.8.3 安装软件")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" -y\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("已安装的，不必重复安装")])]),s._v(" "),e("h3",{attrs:{id:"_2-10-安装node"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-10-安装node","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.10 安装node")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -qO- https://raw.githubusercontent.com/creationix/nvm/v0.35.0/install.sh "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" /root/.bashrc\nnvm "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" stable\nnode -v\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i nrm -g\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("blockquote",[e("p",[s._v("nvm github地址: "),e("a",{attrs:{href:"https://github.com/nvm-sh/nvm",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/nvm-sh/nvm"),e("OutboundLink")],1),e("br"),s._v("\nnvm sh脚本地址: "),e("a",{attrs:{href:"https://github.com/nvm-sh/nvm/blob/master/install.sh",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/nvm-sh/nvm/blob/master/install.sh"),e("OutboundLink")],1),s._v(" "),e("br"),s._v("\nhttps://raw.githubusercontent.com/nvm-sh/nvm/master/install.sh === https://raw.githubusercontent.com/creationix/nvm/v0.35.0/install.sh"),e("br")])]),s._v(" "),e("ul",[e("li",[s._v("命令简单解释")])]),s._v(" "),e("blockquote",[e("p",[s._v("第一行命令自动执行脚本，并配置环境变量"),e("br"),s._v("\n. /root/.bashrc === source /root/.bashrc 使环境变量生效"),e("br"),s._v("\nnvm node版本管理工具 --help查看帮助"),e("br"),s._v("\nnrm node远程镜像代理工具 --help查看帮助")])]),s._v(" "),e("ul",[e("li",[s._v("查看当前npm全局安装的包")])]),s._v(" "),e("blockquote",[e("p",[e("code",[s._v("npm list -g --depth=0")])])]),s._v(" "),e("h3",{attrs:{id:"_2-11-编写node程序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-11-编写node程序","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.11 编写node程序")]),s._v(" "),e("p",[s._v("server.js")]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" http "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" server "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("createServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("statusCode "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("setHeader")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text/html"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("end")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello blog 3000'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nserver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'the server is started at port 3000'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("ul",[e("li",[s._v("上传代码到git服务器，比如:")])]),s._v(" "),e("blockquote",[e("p",[s._v("https://gitee.com/zhufengpeixun/2019blog.git")])]),s._v(" "),e("h3",{attrs:{id:"_2-12-启动程序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-12-启动程序","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.12 启动程序")]),s._v(" "),e("ul",[e("li",[s._v("安装pm2，进程管理器，进程异常退出时pm2会尝试重启，(守护进程运行程序)")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" pm2 -g\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("如果已安装，不必再次安装，pm2 -V查看版本")])]),s._v(" "),e("ul",[e("li",[s._v("clone项目创建server4000.js")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://gitee.com/zhufengpeixun/2019blog.git\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" server.js server4000.js\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("blockquote",[e("p",[s._v("之后编辑文件，将3000部分改成4000")])]),s._v(" "),e("ul",[e("li",[s._v("启动server4000.js")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("pm2 start server4000.js --name "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'server4000'")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("启动命令: pm2 start [fileName] --name [appName]"),e("br"),s._v("\n重启命令: pm2 restart [appName]"),e("br"),s._v("\n查看列表: pm2 list"),e("br"),s._v("\n停止命令: pm2 stop [appName]"),e("br"),s._v("\n删除命令: pm2 delete [appName]"),e("br")])]),s._v(" "),e("ul",[e("li",[s._v("访问4000端口\n访问 "),e("a",{attrs:{href:"http://127.0.0.1:4000",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://127.0.0.1:4000"),e("OutboundLink")],1),s._v(" 或者使用命令")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" http://127.0.0.1:4000\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("查看进程")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" node\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("node 为查看的关键字")])]),s._v(" "),e("ul",[e("li",[s._v("杀死进程(比如处理端口被占用)")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" -9 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("pid"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_2-13-nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-13-nginx","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.13 nginx")]),s._v(" "),e("p",[e("code",[s._v("Nginx")]),s._v("是一个高性能的"),e("code",[s._v("HTTP")]),s._v("和反向代理服务器")]),s._v(" "),e("h4",{attrs:{id:"_2-13-1-nginx安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-13-1-nginx安装","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.13.1 nginx安装")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nginx -y\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_2-13-2-nginx命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-13-2-nginx命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.13.2 nginx命令")]),s._v(" "),e("ul",[e("li",[s._v("启动nginx: "),e("code",[s._v("nginx -c /etc/nginx/nginx.conf")])]),s._v(" "),e("li",[s._v("关闭nginx: "),e("code",[s._v("nginx -s stop")])]),s._v(" "),e("li",[s._v("重读配置文件: "),e("code",[s._v("nginx -s reload")])])]),s._v(" "),e("h4",{attrs:{id:"_2-13-3-nginx配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-13-3-nginx配置","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.13.3 nginx配置")]),s._v(" "),e("ul",[e("li",[s._v("查看配置文件")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/nginx/nginx.conf "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v ^"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# | grep -v ^$")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("| grep -v ^# | grep -v ^$ 排除所有 # 开头的行，排除所有空行")])]),s._v(" "),e("ul",[e("li",[s._v("配置conf")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/nginx/conf.d/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" blog.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("upstream blog"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    server "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nserver "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server_name "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("外网ip或域名"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    location "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        proxy_pass http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("blog"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("blockquote",[e("p",[s._v("配置后，如果没有启动nginx，需要执行 "),e("code",[s._v("nginx -s reload")])])]),s._v(" "),e("ul",[e("li",[s._v("查看端口使用情况")])]),s._v(" "),e("blockquote",[e("p",[e("code",[s._v("netstat -lnpt | grep 80")])])]),s._v(" "),e("ul",[e("li",[s._v("异常处理")])]),s._v(" "),e("blockquote",[e("p",[s._v('nginx: [error] open() "/run/nginx.pid" failed'),e("br"),s._v("\nnginx.conf 中配置了pid /run/nginx.pid"),e("br"),s._v("\n发现并没有/run/nginx.pid这个文件"),e("br"),s._v("\n1, "),e("code",[s._v("ps -ef | grep nginx")]),s._v(" 得到pid 比如20926"),e("br"),s._v("\n2, "),e("code",[s._v("vi /run/nginx.pid")]),s._v(" 将20926赋值进去"),e("br"),s._v("\n3, "),e("code",[s._v("nginx -s reload")])])]),s._v(" "),e("h3",{attrs:{id:"_2-14-nginx常规配置参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-14-nginx常规配置参考","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.14 nginx常规配置参考")]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("user  nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nworker_processes  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nevents "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  worker_connections  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nhttp "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  include       mime"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("types"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  default_type  application"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("octet"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("stream"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  sendfile        on"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  keepalive_timeout  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  # 不推荐的配置方法\n  server"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8090")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    server_name "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8090")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    location "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      root "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("web_dist"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      index index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("htm"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      try_files $uri $uri"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  server"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    listen  "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    # ip"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("port 或 域名\n    server_name "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    # 比如，公众号要求 txt文件安全认证\n    location "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("txt"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("$ "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      root "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("txt"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    # 不缓存页面\n    location "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("hello"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("world "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        alias "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("hello"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("world"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        add_header Last"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Modified $date_gmt"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        expires "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("s"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        index index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("htm"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        try_files $uri $uri"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("hello"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("world"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    # 跨域请求\n    location "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      add_header Access"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Allow"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Origin "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      add_header Access"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Allow"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Credentials "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'true'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      add_header Access"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Allow"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Methods "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'GET, POST, OPTIONS'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      add_header Access"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Allow"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Headers "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'DNT,web-token,app-token,Authorization,Accept,Origin,Keep-Alive,User-Agent,X-Mx-ReqToken,X-Data-Type,X-Auth-Token,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      add_header Access"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Expose"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Headers "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Length,Content-Range'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("$request_method "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'OPTIONS'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        add_header "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Access-Control-Max-Age'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1728000")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        add_header "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'text/plain; charset=utf-8'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        add_header "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Length'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("204")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      root "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    # "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" 放到最后\n    location "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      root "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      index index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("htm"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      try_files $uri $uri"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("index"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br")])]),e("ul",[e("li",[s._v("打包方式")])]),s._v(" "),e("ol",[e("li",[e("strong",[s._v("web_dist")]),s._v(" 项目使用绝对路径 (配合 8090 端口)，不推荐")]),s._v(" "),e("li",[e("strong",[s._v("mobile")]),s._v(" 项目使用相对路径"),e("br"),s._v("\npublicPath: './' （或 publicPath: ''）"),e("br")]),s._v(" "),e("li",[e("strong",[s._v("推荐")]),s._v(" "),e("strong",[s._v("hello-world")]),s._v(" 项目使用绝对路径"),e("br"),s._v("\npublicPath: '/hello-world'"),e("br"),s._v(" "),e("strong",[s._v("推荐该方式")]),s._v("，相比于"),e("code",[s._v("2")]),s._v("，可以更好地配置请求路径，如public文件夹下的文件等。")])]),s._v(" "),e("ul",[e("li",[s._v("访问地址(部署后最终效果)")])]),s._v(" "),e("ol",[e("li",[s._v("http://192.168.3.2 => nginx首页")]),s._v(" "),e("li",[s._v("http://192.168.3.2:8090 => web_dist项目")]),s._v(" "),e("li",[s._v("http://192.168.3.2/mobile => mobile项目")]),s._v(" "),e("li",[s._v("http://1926.168.3.2/hello-world => hello-world项目")])]),s._v(" "),e("h2",{attrs:{id:"_3-docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-docker","aria-hidden":"true"}},[s._v("#")]),s._v(" 3. Docker")]),s._v(" "),e("ul",[e("li",[s._v("Docker 是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的镜像中，然后发布到任何流行的 Linux或Windows 机器上，也可以实现虚拟化。容器是完全使用沙箱机制，相互之间不会有任何接口")])]),s._v(" "),e("h3",{attrs:{id:"_3-1-docker版本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-docker版本","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.1 docker版本")]),s._v(" "),e("ul",[e("li",[s._v("docker分为企业版(EE)和社区版(CE)")]),s._v(" "),e("li",[s._v("docker-ce社区版地址: "),e("a",{attrs:{href:"https://docs.docker.com/install/linux/docker-ce/centos/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.docker.com/install/linux/docker-ce/centos/"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("docker-hub镜像中心地址: "),e("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://hub.docker.com/"),e("OutboundLink")],1)])]),s._v(" "),e("h3",{attrs:{id:"_3-2-docker安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-docker安装","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.2 docker安装")]),s._v(" "),e("h4",{attrs:{id:"_3-2-1-卸载旧版本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-1-卸载旧版本","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.2.1 卸载旧版本")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("yum remove docker "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-client "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-client-latest "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-common "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-latest "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-latest-logrotate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-logrotate "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                docker-engine\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("blockquote",[e("p",[s._v("卸载需谨慎，请先查看")])]),s._v(" "),e("h4",{attrs:{id:"_3-2-2-安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-2-安装","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.2.2 安装")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils device-mapper-persistent-data lvm2\nyum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\nyum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y docker-ce docker-ce-cli containerd.io\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("blockquote",[e("p",[s._v("device-mapper-persistent-data: 存储驱动，Linux上的许多高级卷管理技术 lvm: 逻辑卷管理器，用于创建逻辑磁盘分区使用")])]),s._v(" "),e("h4",{attrs:{id:"_3-2-3-优化安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-3-优化安装","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.2.3 优化安装")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils device-mapper-persistent-data lvm2\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\nyum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y docker-ce\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("blockquote",[e("p",[s._v("使用阿里云镜像安装"),e("br"),s._v("\n只安装"),e("code",[s._v("docker-ce")])])]),s._v(" "),e("h4",{attrs:{id:"_3-2-3-常见异常"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-3-常见异常","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.2.3 常见异常")]),s._v(" "),e("ul",[e("li",[s._v("在执行"),e("code",[s._v("3.2.2")]),s._v("第2行时，有时会出现异常")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('"Could not resolve host: download.docker.com; 未知的错误"\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("原因在于首次请求docker地址，无法直接下载")])]),s._v(" "),e("ul",[e("li",[s._v("解决方法")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" https://download.docker.com/linux/centos/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("ol",[e("li",[s._v("先请求通docker地址，会返回网页内容"),e("br")]),s._v(" "),e("li",[s._v("然后可以执行"),e("code",[s._v("3.2.2")]),s._v("第2行和第3行命令")])])]),s._v(" "),e("h4",{attrs:{id:"_3-2-4-其他安装方式参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-4-其他安装方式参考","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.2.4 其他安装方式参考")]),s._v(" "),e("p",[s._v("建议使用3.2.2官方提供方式")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -qO- https://get.docker.com "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("关键词")])]),s._v(" "),e("blockquote",[e("p",[s._v("sudo 给普通用户root权限，便于安装"),e("br"),s._v("\nwget 下载命令（常见的curl属于另一种）"),e("br"),s._v("\n-q 简化模式，简化太多输出"),e("br"),s._v("\nO- 输出依赖，依赖标准模式，不依赖简单文件系统"),e("br"),s._v("\nsh 管道，将命令发送给shell，利用shell运行")])]),s._v(" "),e("ul",[e("li",[s._v("添加用户到docker组，允许普通用户使用docker")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -aG docker "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_3-3-启动docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-启动docker","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.3 启动docker")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl start docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_3-4-查看docker信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-查看docker信息","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.4 查看docker信息")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker info\ndocker version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"_3-5-docker架构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-docker架构","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.5 Docker架构")]),s._v(" "),e("p",[e("img",{attrs:{src:t(243),alt:"docker-arch"}})]),s._v(" "),e("h3",{attrs:{id:"_3-6-阿里云加速"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-阿里云加速","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.6 阿里云加速")]),s._v(" "),e("ul",[e("li",[s._v("镜像仓库: "),e("a",{attrs:{href:"https://dev.aliyun.com/search.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://dev.aliyun.com/search.html"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("镜像加速器: "),e("a",{attrs:{href:"https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("配置加速器镜像")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /etc/docker\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n  "registry-mirrors": ["https://fwvjnv59.mirror.aliyuncs.com"]\n}\nEOF')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("blockquote",[e("p",[s._v("其中 https://fwvjnv59.mirror.aliyuncs.com 可以通过"),e("code",[s._v("镜像加速器")]),s._v("链接找到，即镜像加速器地址")])]),s._v(" "),e("h3",{attrs:{id:"_3-7-服务启动解析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-服务启动解析","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.7 服务启动解析")]),s._v(" "),e("ul",[e("li",[s._v("运行镜像并执行命令")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker run ubuntu /bin/echo "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello world"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("docker: Docker 的二进制执行文件"),e("br"),s._v("\nrun: 与前面的 docker 组合来运行一个容器"),e("br"),s._v("\nubuntu指定要运行的镜像，Docker首先从本地主机上查找镜像是否存在，如果不存在，Docker 就会从镜像仓库 Docker Hub 下载公共镜像"),e("br"),s._v('\n/bin/echo "Hello world": 在启动的容器里执行的命令')])]),s._v(" "),e("ul",[e("li",[s._v("运行新镜像并启动bash脚本")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker container run -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3333")]),s._v(":3000 -it zhufengblog /bin/bash\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" start\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("blockquote",[e("p",[s._v("-p 参数是将容器的3000端口映射为本机的3333端口"),e("br"),s._v("\n-it 参数是将容器的shell容器映射为当前的shell,在本机容器中执行的命令都会发送到容器当中执行\nzhufengblog image的名称"),e("br"),s._v("\n/bin/bash 容器启动后执行的第一个命令,这里是启动了bash容器以便执行脚本")])]),s._v(" "),e("h3",{attrs:{id:"_3-8-启动node服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-启动node服务","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.8 启动node服务")]),s._v(" "),e("h4",{attrs:{id:"_3-8-1-创建目录及server-js文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-1-创建目录及server-js文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.8.1 创建目录及server.js文件")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" dockerenv\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" dockerenv/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" app\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" app\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" server.js\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("blockquote",[e("p",[s._v("将server.js内容粘贴进server.js"),e("br"),s._v("\npwd命令显示为 /root/dockerenv/app")])]),s._v(" "),e("ul",[e("li",[s._v("初始化app目录为npm目录")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" i -y\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" package.json\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("blockquote",[e("p",[s._v("编辑并确保 npm start 运行 node server.js")])]),s._v(" "),e("h4",{attrs:{id:"_3-8-2-dockerfile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-2-dockerfile","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.8.2 Dockerfile")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/dockerenv/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" Dockerfile\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FROM")]),s._v(" node\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("COPY")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("app "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("app\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WORKDIR")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("app\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUN")]),s._v(" npm install\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXPOSE")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMD")]),s._v(" npm start\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("blockquote",[e("p",[s._v("FROM 表示该镜像继承的镜像 :表示标签"),e("br"),s._v("\nCOPY 是将当前目录下的app目录下面的文件都拷贝到image里的/app目录中"),e("br"),s._v("\nWORKDIR 指定工作路径，类似于执行 cd 命令"),e("br"),s._v("\nRUN命令在 image 文件的构建阶段执行,RUN npm install 在/app目录下安装依赖，安装后的依赖也会打包到image目录中"),e("br"),s._v("\nEXPOSE 暴露3000端口，允许外部连接这个端口"),e("br"),s._v("\nCMD命令在容器启动后执行"),e("br")])]),s._v(" "),e("blockquote",[e("p",[e("em",[s._v("一个 Dockerfile 可以包含多个RUN命令，但是只能有一个CMD命令")]),e("br"),s._v(" "),e("em",[s._v("指定了CMD命令以后，docker container run命令就不能附加命令了(比如前面的/bin/bash),否则它会覆盖CMD命令")])])]),s._v(" "),e("h4",{attrs:{id:"_3-8-3-创建image"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-3-创建image","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.8.3 创建image")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker build -t zhufengblog "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("-t用来指定image镜像的名称，后面还可以加冒号指定标签，如果不指定默认就是latest"),e("br"),s._v("\n. 表示Dockerfile文件的所有路径,.就表示当前路径")])]),s._v(" "),e("h4",{attrs:{id:"_3-8-4-启动容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-4-启动容器","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.8.4 启动容器")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker run -d -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v(":3000 zhufengblog\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("-d 以后台方式运行，即退出当前用户命令链接，容器不会死掉"),e("br"),s._v("\n-p 端口映射 :右边 --映射为--\x3e 左边:")]),s._v(" "),e("blockquote",[e("p",[s._v("冒号左边是外网访问端口，冒号右边是docker容器端口")])])]),s._v(" "),e("h3",{attrs:{id:"_3-9-测试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-9-测试","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.9 测试")]),s._v(" "),e("ul",[e("li",[s._v("前边已经配置好nginx")]),s._v(" "),e("li",[s._v("pm2方式已经启动server4000")]),s._v(" "),e("li",[s._v("开启浏览器输入 http://ip")]),s._v(" "),e("li",[s._v("如当前为3000，开启浏览器新标签页，会变成4000")])]),s._v(" "),e("div",{staticClass:"language-flow line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-flow"}},[e("code",[s._v("nginx \n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" server3000 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("zhufengblog"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" server4000 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("pm2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("server4000"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"_4-docker命令参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-docker命令参考","aria-hidden":"true"}},[s._v("#")]),s._v(" 4. Docker命令参考")]),s._v(" "),e("h3",{attrs:{id:"_4-1-docker基础命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-docker基础命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 4.1 docker基础命令")]),s._v(" "),e("ul",[e("li",[s._v("查看docker volume帮助")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker volumn --help\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("volumn可以将数据及配置等，持久化的挂载到docker/volumns上")])]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("进入docker容器")])])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("container-id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("-it将docker容器shell映射到当前主机"),e("br"),s._v("\n[container-id]或者[image-name]都可执行"),e("br"),s._v("\n/bin/bash可以简写成bash，代表进入容器后运行bash")])]),s._v(" "),e("ul",[e("li",[s._v("根据DockerFile创建镜像")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker build -t hello_docker "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("-t 给镜像添加标签"),e("br"),s._v("\n.  根据当前目录的所有 Dockerfile 文件创建镜像")])]),s._v(" "),e("h3",{attrs:{id:"_4-2-docker镜像命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-docker镜像命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 4.2 docker镜像命令")]),s._v(" "),e("ul",[e("li",[s._v("查看镜像")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker images\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("拉取镜像")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker pull gitlab/gitlab-ce:latest\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("daemon方式运行镜像")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker run -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":80 -d nginx\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("-p 端口映射 80 --映射为--\x3e 8080"),e("br"),s._v("\n-d 以后台方式运行，即退出当前用户命令链接，容器不会死掉")])]),s._v(" "),e("ul",[e("li",[s._v("删除镜像")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker rmi "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("image-id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_4-3-docker容器命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-docker容器命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 4.3 docker容器命令")]),s._v(" "),e("ul",[e("li",[s._v("查看运行中的容器")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("查看所有容器")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("删除容器")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("container-id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("停止容器")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker stop "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("container-id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("将容器提交成镜像")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker commit -m "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'message'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("container-id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("image-name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("拷贝文件到容器")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("fileName"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("container-id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("://usr/share/nginx/html\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_4-4-docker-compose命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-docker-compose命令","aria-hidden":"true"}},[s._v("#")]),s._v(" 4.4 docker-compose命令")]),s._v(" "),e("p",[s._v("docker多容器管理")]),s._v(" "),e("ul",[e("li",[s._v("创建文件")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ~/dockerenv/compose\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" docker-compose.yml\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" docker-compose.yml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("blockquote",[e("p",[s._v("创建后，编写相关配置"),e("br"),s._v("\ncd 到 docker-compose.yml 目录下")])]),s._v(" "),e("ul",[e("li",[s._v("运行")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker-compose up -d\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("停止")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker-compose stop\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("删除")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker-compose "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("构建")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker-compose build\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("查看日志")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker-compose logs -f\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"_5-docker修改data目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-docker修改data目录","aria-hidden":"true"}},[s._v("#")]),s._v(" 5. docker修改data目录")]),s._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://docs.docker.com/config/daemon/systemd/#custom-docker-daemon-options",target:"_blank",rel:"noopener noreferrer"}},[s._v("修改daemon.json"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("为了减少系统磁盘压力，可以将docker镜像、容器、volumes放到挂载的目录(/mnt/data/docker)")])]),s._v(" "),e("h3",{attrs:{id:"_5-1-显示docker目录下所有文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-显示docker目录下所有文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.1 显示docker目录下所有文件")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("du")]),s._v(" /var/lib/docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_5-2-查看docker信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-查看docker信息","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.2 查看docker信息")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker info\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("Storage Driver: overlay2"),e("br"),s._v("\nDocker Root Dir: /var/lib/docker"),e("br"),s._v("\nRegistry Mirrors: https://21f73xp7.mirror.aliyuncs.com/"),e("br")])]),s._v(" "),e("h3",{attrs:{id:"_5-3-创建data-root目录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-创建data-root目录","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.3 创建data-root目录")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /mnt/data/docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("如果docker中已经有镜像，需要执行拷贝")])]),s._v(" "),e("blockquote",[e("p",[s._v("cp /var/lib/docker /mnt/data/docker")])]),s._v(" "),e("h3",{attrs:{id:"_5-4-停止docker服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-停止docker服务","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.4 停止docker服务")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl stop docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_5-5-编辑daemon-json"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-编辑daemon-json","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.5 编辑daemon.json")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language-py line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-py"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://21f73xp7.mirror.aliyuncs.com"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data-root"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/mnt/data/docker"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"storage-driver"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"overlay2"')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("blockquote",[e("p",[e("code",[s._v("overlay2")]),s._v("来自"),e("code",[s._v("docker info")]),s._v("的信息")])]),s._v(" "),e("h3",{attrs:{id:"_5-6-显示docker新目录下所有文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-显示docker新目录下所有文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.6 显示docker新目录下所有文件")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("du")]),s._v(" /mnt/data/docker/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_5-7-查看docker信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-7-查看docker信息","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.7 查看docker信息")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker info\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("Docker Root Dir: /mnt/data/docker"),e("br")])]),s._v(" "),e("h3",{attrs:{id:"_5-8-查看docker镜像信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-查看docker镜像信息","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.8 查看docker镜像信息")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker inspect "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("image-id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("最后看到镜像对应路径为"),e("code",[s._v("新路径")])])]),s._v(" "),e("h2",{attrs:{id:"_6-docker-compose"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-docker-compose","aria-hidden":"true"}},[s._v("#")]),s._v(" 6. docker-compose")]),s._v(" "),e("p",[s._v("docker-compose安装的前提是先安装"),e("code",[s._v("docker")])]),s._v(" "),e("h3",{attrs:{id:"_6-1-官网路径"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-官网路径","aria-hidden":"true"}},[s._v("#")]),s._v(" 6.1 官网路径")]),s._v(" "),e("p",[s._v("github地址："),e("a",{attrs:{href:"https://github.com/docker/compose",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/docker/compose"),e("OutboundLink")],1),e("br"),s._v("\n官方文档："),e("a",{attrs:{href:"https://docs.docker.com/compose/cli-command/#install-on-linux",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.docker.com/compose/cli-command/#install-on-linux"),e("OutboundLink")],1),e("br"),s._v("\nyml文件格式与内核关系："),e("a",{attrs:{href:"https://docs.docker.com/compose/compose-file/compose-file-v3/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.docker.com/compose/compose-file/compose-file-v3/"),e("OutboundLink")],1)]),s._v(" "),e("h3",{attrs:{id:"_6-2-旧版安装-1-9-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-旧版安装-1-9-2","aria-hidden":"true"}},[s._v("#")]),s._v(" 6.2 旧版安装(1.9.2)")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("br"),e("br"),e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/docker/compose/releases/download/1.29.2/docker-compose-'),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -s"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("-"),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -m"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" -o /usr/local/bin/docker-compose\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/bin/docker-compose\ndocker-compose --version\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("blockquote",[e("p",[s._v("命令使用"),e("code",[s._v("docker-compose")]),s._v("，而新版里使用"),e("code",[s._v("docker compose")])])]),s._v(" "),e("h3",{attrs:{id:"_6-3-给当前用户安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-给当前用户安装","aria-hidden":"true"}},[s._v("#")]),s._v(" 6.3 给当前用户安装")]),s._v(" "),e("ul",[e("li",[s._v("查看版本信息\n"),e("a",{attrs:{href:"https://github.com/docker/compose/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/docker/compose/releases"),e("OutboundLink")],1)]),s._v(" "),e("li",[s._v("安装（"),e("code",[s._v("v2.2.3")]),s._v("举例）")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br"),e("br"),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p ~/.docker/cli-plugins/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -SL https://github.com/docker/compose/releases/download/v2.2.3/docker-compose-linux-x86_64 -o ~/.docker/cli-plugins/docker-compose\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x ~/.docker/cli-plugins/docker-compose\ndocker compose version\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"_6-4-给所有用户安装-推荐"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-给所有用户安装-推荐","aria-hidden":"true"}},[s._v("#")]),s._v(" 6.4 给所有用户安装 "),e("strong",[s._v("(推荐)")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("div",{staticClass:"highlight-lines"},[e("div",{staticClass:"highlighted"},[s._v(" ")]),e("br"),e("br"),e("br"),e("br")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /usr/local/lib/docker/cli-plugins\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -SL https://github.com/docker/compose/releases/download/v2.2.3/docker-compose-linux-x86_64 -o /usr/local/lib/docker/cli-plugins/docker-compose\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/local/lib/docker/cli-plugins/docker-compose\ndocker compose version\n")])]),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);